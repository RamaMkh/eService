USE [Microclearlight_BPMigration_Dev]
GO

/****** Object:  View [etrade].[CustomsSystemUserActivities_BPN]    Script Date: 1/31/2024 2:06:50 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

ALTER   view [etrade].[CustomsSystemUserActivities_BPN]

AS

Select distinct Convert(int,oa.PersonalId) as CustomsSystemUserId,oa.OrganizationId
,oa.ActivityId as CustomsBusinessActivityId , ob.StatusId,BAS.ValueEnglish as StatusEnglishName ,BAS.ValueArabic as StatusArabicName,
BA.NameEnglish as ActivityNameEnglish,
BA.NameArabic as ActivityNameArabic,
oa.DateCreated,
case when oa.stateid ='OrgUserActivitiesDeletedState' then 'Deleted' --removed
else 'Associated'
end as Availability

From OrgUserActivities oa
left join etrade.OrganizationCustomsBusinessActivities_BPN ob on oa.OrganizationId = ob.OrganizationId and oa.ActivityId = ob.CustomsBusinessActivityId
left join etrade.CustomsBusinessActivityStatuses BAS on ob.StatusId = BAS.Id
left join etrade.CustomsBusinessActivities_BPN BA on BA.Id =ob.CustomsBusinessActivityId

 
GO

