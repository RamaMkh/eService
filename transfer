
/****** Object:  View [etrade].[CustomsSystemUserActivities_BPN]    Script Date: 1/17/2024 11:58:36 AM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO


/* View created to replace the table object "etrade.CustomsSystemUserActivities" and use it as view 

"etrade.CustomsSystemUserActivities", team shall rename the view name.*/

ALTER   view [etrade].[CustomsSystemUserActivities_BPN]

AS

Select distinct Convert(int,oa.PersonalId) as CustomsSystemUserId,oa.ActivityId as CustomsBusinessActivityId , ob.StatusId,
 CASE
        WHEN oa.ActivityId exists( select activityid FROM OrgUserActivities) THEN 'Added' --added
        ELSE 'Removed'--removed
    END AS RequestStatus

From OrgUserActivities oa
left join etrade.OrganizationCustomsBusinessActivities_BPN ob on oa.OrganizationId = ob.OrganizationId and oa.ActivityId = ob.CustomsBusinessActivityId
left join [$OrgUserActivities] AuOa on  AuOa.PersonalId =oa.PersonalId
 
 where oa.PersonalId= 1861104

GO

